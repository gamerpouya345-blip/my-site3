<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ุฏุงุดุจูุฑุฏ ฺฉุงุฑุจุฑ</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h2>ุฏุงุดุจูุฑุฏ ุดูุง</h2>
    <div id="welcome"></div>
    
    <button id="spinBtn" class="btn">ฺุฑุฎุงูุฏู ฺฏุฑุฏููู ุดุงูุณ ๐ก</button>
    
    <div id="result"></div>
    
    <div id="reward" style="margin-top:20px;"></div>
    
    <button id="logoutBtn" class="btn">ุฎุฑูุฌ</button>
  </div>

  <script src="spin.js"></script>
  <script>
    const welcome = document.getElementById('welcome');
    const spinBtn = document.getElementById('spinBtn');
    const result = document.getElementById('result');
    const reward = document.getElementById('reward');
    const logoutBtn = document.getElementById('logoutBtn');

    // ฺฺฉ ุซุจุชโูุงู
    const user = JSON.parse(localStorage.getItem('user'));
    if (!user) {
      alert('ุงุจุชุฏุง ุจุงุฏ ุซุจุชโูุงู ฺฉูุฏ.');
      window.location.href = 'register.html';
    } else {
      welcome.textContent = `ุณูุงูุ ${user.username} ุนุฒุฒ!`;
    }

    spinBtn.addEventListener('click', () => {
      // ุฌููฺฏุฑ ุงุฒ ฺุฑุฎุด ฺูุฏุจุงุฑู
      if (localStorage.getItem('hasSpun')) {
        result.textContent = 'ุดูุง ูุจูุง ฺฏุฑุฏููู ุฑุง ฺุฑุฎุงูุฏูโุงุฏ.';
        return;
      }
      spinBtn.disabled = true;
      result.textContent = 'ุฏุฑ ุญุงู ฺุฑุฎุด...';

      // ฺุฑุฎุด ฺฏุฑุฏููู ุดุงูุณ ู ูุชุฌู
      setTimeout(() => {
        const prize = spin();
        result.textContent = `ุชุจุฑฺฉ! ุดูุง ุจุฑูุฏู: ${prize}`;
        reward.innerHTML = `
          <p>ุจุฑุง ุฏุฑุงูุช ุฌุงุฒูุ ุจู ุขุฏ ุชูฺฏุฑุงู ูพุงู ุฏูุฏ:</p>
          <a href="https://t.me/${user.telegramId}" target="_blank">@${user.telegramId}</a>
        `;
        localStorage.setItem('hasSpun', 'true');
      }, 2000);
    });

    logoutBtn.addEventListener('click', () => {
      localStorage.clear();
      window.location.href = 'index.html';
    });
  </script>
</body>
</html>
